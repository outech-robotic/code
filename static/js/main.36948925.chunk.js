(this["webpackJsonpoutech-debug"]=this["webpackJsonpoutech-debug"]||[]).push([[0],{167:function(e,t,n){},169:function(e,t,n){},170:function(e,t,n){},173:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(58),c=n.n(o),i=(n(70),n(2)),l=n(20),u=n(8),s=n(59),m=(n(165),{pan:{enabled:!0,mode:"xy"},zoom:{enabled:!0,mode:"xy"},maintainAspectRatio:!1,animation:{duration:0},hover:{animationDuration:0},responsiveAnimationDuration:0,elements:{line:{tension:0}}});function f(e){var t=e.value,n=e.seriesName,a=e.color,o=r.a.useRef(),c={datasets:[{label:n,fill:!1,pointStyle:"cross",borderColor:a,pointBorderColor:a,pointHoverRadius:20,pointHoverBorderWidth:2,pointRadius:2,pointHitRadius:10,showLine:!0,borderWidth:1,data:t.slice(-1e3)}]};return r.a.createElement("div",{style:{height:"100%"}},r.a.createElement("button",{type:"button",onClick:function(){return o.current.chartInstance.resetZoom()}},"reset zoom"),"Number of points: ",c.datasets[0].data.length,r.a.createElement(s.a,{ref:o,data:c,options:m,color:"blue"}))}n(167);var d=n(11),p=n(14),v=n(27),h=n(15);function b(e){var t=e.title,n=e.data;return r.a.createElement("button",{onClick:function(){var e=function(){var e,t={},a=Object(h.a)(n.entries());try{for(a.s();!(e=a.n()).done;){var r,o=Object(i.a)(e.value,2),c=o[0],l=o[1],u=Object(h.a)(l);try{for(u.s();!(r=u.n()).done;){var s=r.value,m=t[s.x]||{};t[s.x]=Object(v.a)({},m,Object(p.a)({},c,s.y))}}catch(f){u.e(f)}finally{u.f()}}}catch(f){a.e(f)}finally{a.f()}return t}(),a=Object.keys(e).map((function(e){return parseFloat(e)})).sort().map((function(t){for(var a=e[t],r=[t],o=0;o<n.length;o++)r.push(a[o]);return r}));!function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}("graph.csv",[["time"].concat(Object(d.a)(t))].concat(Object(d.a)(a)).reduce((function(e,t){return e+t.join()+"\n"}),""))}},"Download CSV")}function g(e){var t=e.encoderLeft,n=e.encoderRight,a=e.speedLeft,o=e.speedRight;return r.a.createElement("div",{id:"graphContainer"},r.a.createElement(b,{title:["encoder_left","encoder_right"],data:[t,n]}),r.a.createElement("div",{className:"graphRow"},r.a.createElement("div",{className:"graphElement"},r.a.createElement(f,{value:t,seriesName:"Position left",color:"royalblue"})),r.a.createElement("div",{className:"graphElement"},r.a.createElement(f,{value:n,seriesName:"Position right",color:"salmon"}))),r.a.createElement("div",{className:"graphRow"},r.a.createElement("div",{className:"graphElement"},r.a.createElement(f,{value:a,seriesName:"Speed left",color:"royalblue"})),r.a.createElement("div",{className:"graphElement"},r.a.createElement(f,{value:o,seriesName:"Speed right",color:"salmon"}))))}var E=n(3),y=n.n(E),O=n(12);function j(e,t){var n=Object(a.useState)(),r=Object(i.a)(n,2),o=r[0],c=r[1];return Object(a.useEffect)((function(){void 0!==t&&(t?function(e,t){console.log("Opening web socket");var n=new WebSocket(t);n.onopen=function(){console.log("Opened")},n.onmessage=function(t){var n,a=JSON.parse(t.data),r=Object(h.a)(a);try{for(r.s();!(n=r.n()).done;){var o=n.value;e(o)}}catch(c){r.e(c)}finally{r.f()}}}(c,e):function(e,t){w.apply(this,arguments)}(c,e))}),[e,t]),o}function w(){return(w=Object(O.a)(y.a.mark((function e(t,n){var a,r,o,c,i,l,u,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Fetching remote replay"),e.next=3,fetch(n);case 3:return a=e.sent,e.next=6,a.json();case 6:r=e.sent,o=r.events,console.log("Fetched remote replay!"),c=o[0].time,i=new Date,l=Object(h.a)(r.events),e.prev=12,s=y.a.mark((function e(){var n,a,r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.value,a=n.time-c,r=(new Date-i)/1e3,o=a-r,e.next=6,new Promise((function(e){return setTimeout(e,1e3*o)}));case 6:t(n);case 7:case"end":return e.stop()}}),e)})),l.s();case 15:if((u=l.n()).done){e.next=19;break}return e.delegateYield(s(),"t0",17);case 17:e.next=15;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(12),l.e(e.t1);case 24:return e.prev=24,l.f(),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[12,21,24,27]])})))).apply(this,arguments)}function k(e){var t=e.type,n=e.defaultValue,a=e.onChange;if("float"===t||"int"===t){return r.a.createElement("input",{onChange:function(e){return a(parseFloat(e.target.value))},type:"number",step:"any",defaultValue:n,placeholder:t})}return r.a.createElement("input",{onChange:function(e){return a(e.target.value)},defaultValue:n,type:"text",placeholder:t})}function x(e){var t=e.args,n=e.lastArgs,o=e.onSubmit,c=Object(a.useReducer)((function(e,t){return Object(v.a)({},e,Object(p.a)({},t.key,t.value))}),{}),l=Object(i.a)(c,2),u=l[0],s=l[1],m=function(){var e=Object(O.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),o(u);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){for(var e=0,a=Object.keys(t);e<a.length;e++){var r=a[e];s({key:r,value:n[r]})}}),[t,n]),r.a.createElement("form",{onSubmit:m},r.a.createElement("ul",null,Object.keys(t).map((function(e){return r.a.createElement("li",{key:e},r.a.createElement("label",{htmlFor:e},e),":",r.a.createElement(k,{name:e,type:t[e],onChange:(a=e,function(e){return s({key:a,value:e})}),defaultValue:n[e]}));var a}))),r.a.createElement("input",{type:"submit"}))}function R(e){var t=e.actionURL,n=Object(a.useState)([]),o=Object(i.a)(n,2),c=o[0],l=o[1];function u(e,t){return s.apply(this,arguments)}function s(){return(s=Object(O.a)(y.a.mark((function e(n,a){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("sending action",n,a),e.next=3,fetch(t,{method:"POST",body:JSON.stringify({name:n,args:a})});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){function e(){return(e=Object(O.a)(y.a.mark((function e(t){var n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.json();case 5:a=e.sent,console.log(a),l(a.functions);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t&&function(t){e.apply(this,arguments)}(t)}),[t]),t?r.a.createElement("div",null,r.a.createElement("ul",null,c.map((function(e){var t=function(){var t=Object(O.a)(y.a.mark((function t(n){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u(e.name,n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("li",{key:e.name},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("strong",null,"Name"),": ",e.name),r.a.createElement("li",null,r.a.createElement("strong",null,"Documentation"),": ",e.documentation),r.a.createElement("li",null,r.a.createElement("strong",null,"Arguments:"),r.a.createElement(x,{args:e.args,lastArgs:e.last_args_sent,onSubmit:t}))))})))):r.a.createElement("div",null,r.a.createElement("p",null,"Set the action link in the URL to be able to perform actions."),r.a.createElement("p",null,"Example: http://localhost:3000/code/actions?live=ws://localhost:8080",r.a.createElement("strong",null,"&action=http://localhost:9090")))}n(169),n(170);var S=n(61),C=n.n(S),N=n(62),L=n.n(N);function P(e){if(void 0!==e)return e.value}function A(e){var t=e.robotPositionEvent,n=e.robotAngleEvent,o=e.configuration,c=r.a.useRef(),i=r.a.useRef(),l=P(t),u=P(n);return Object(a.useEffect)((function(){var e=document.getElementById("robotField");if(e.getContext){var t=e.getContext("2d");t.globalCompositeOperation="source-over",t.clearRect(0,0,3e3,2e3),t.save(),t.drawImage(c.current,0,0,3e3,2e3),void 0!==o&&function(e,t,n,a,r,o){if(void 0!==t){var c=t.x,i=t.y;e.save(),e.translate(c,2e3-i),e.rotate(-n),e.beginPath(),e.strokeStyle="red",e.lineWidth=4,e.strokeRect(-a/2,-r/2,a,r),e.stroke(),e.rotate(-Math.PI/2),e.drawImage(o,-r/2,-a/2,r,a),e.beginPath(),e.strokeStyle="white",e.lineWidth=4,e.moveTo(0,-a/4),e.lineTo(0,a/4),e.lineTo(-20,a/4-40),e.moveTo(0,a/4),e.lineTo(20,a/4-40),e.stroke(),e.restore()}}(t,l,u,o.robot_length,o.robot_width,i.current),t.restore()}}),[l,u,o]),r.a.createElement("div",null,"Robot position: ",JSON.stringify(l),"Robot angle: ",u,r.a.createElement("canvas",{id:"robotField",width:"3000",height:"2000"},"This page does not work, get a better (newer) browser."),r.a.createElement("img",{alt:"plateau",ref:c,src:C.a,style:{display:"none"}}),r.a.createElement("img",{alt:"robot",ref:i,src:L.a,style:{display:"none"}}))}function _(e,t){var n=Object(a.useState)(),r=Object(i.a)(n,2),o=r[0],c=r[1];return Object(a.useEffect)((function(){void 0!==e&&e.key===t&&c(e)}),[e,t]),o}function T(e){var t=Object(a.useReducer)((function(e,t){return void 0===t?e:[].concat(Object(d.a)(e),[t])}),[]),n=Object(i.a)(t,2),r=n[0],o=n[1];return Object(a.useEffect)((function(){o(e)}),[e]),r}var D=function(e,t){var n=function(e,t){var n=Object(a.useState)(),r=Object(i.a)(n,2),o=r[0],c=r[1];return Object(a.useEffect)((function(){void 0!==e&&(void 0!==o?e.time-o.time>1/t&&c(e):c(e))}),[e,t,o]),o}(_(e,t),10),r=Object(a.useMemo)((function(){return function(e){if(void 0!==e)return{x:e.time,y:e.value}}(n)}),[n]),o=function(e){var t=Object(a.useReducer)((function(e,t){return void 0===t?e:[].concat(Object(d.a)(e),[t]).slice(-2)}),[]),n=Object(i.a)(t,2),r=n[0],o=n[1];return Object(a.useEffect)((function(){o(e)}),[e]),Object(a.useMemo)((function(){return function(e){if(!(e.length<=1)){var t=e[e.length-1];return{x:t.x,y:(t.y-e[0].y)/(t.x-e[0].x)}}}(r)}),[r])}(r);return[T(r),T(o)]};function F(e){var t=e.event$,n=e.actionURL,a=P(_(t,"configuration")),o=D(t,"encoder_left"),c=Object(i.a)(o,2),s=c[0],m=c[1],f=D(t,"encoder_right"),d=Object(i.a)(f,2),p=d[0],v=d[1],h=_(t,"position"),b=_(t,"angle");return r.a.createElement(l.a,null,r.a.createElement("div",null,r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(l.b,{to:"/code/actions"+window.location.search},"Actions")),r.a.createElement("li",null,r.a.createElement(l.b,{to:"/code/encoder_graph"+window.location.search},"Encoder graph")),r.a.createElement("li",null,r.a.createElement(l.b,{to:"/code/simulation"+window.location.search},"Simulation")))),r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/code/simulation"},r.a.createElement(A,{robotPositionEvent:h,robotAngleEvent:b,configuration:a})),r.a.createElement(u.b,{path:"/code/actions"},r.a.createElement(R,{actionURL:n})),r.a.createElement(u.b,{path:"/code/encoder_graph"},r.a.createElement(g,{encoderLeft:s,encoderRight:p,speedLeft:m,speedRight:v})),r.a.createElement(u.b,{path:"/"},r.a.createElement(u.a,{to:"/code/simulation"+window.location.search})))))}function I(){var e=new URLSearchParams(window.location.search),t=e.get("replay"),n=e.get("live"),a=e.get("action"),o=t?[t,!1]:n?[n,!0]:[void 0,void 0],c=Object(i.a)(o,2),l=j(c[0],c[1]);return n||t?n&&t?r.a.createElement("div",null,'Cannot set both "replay" and "live" in query.'):r.a.createElement(F,{event$:l,actionURL:a}):r.a.createElement("div",null,'Please set either "live" or "replay" in query.')}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},61:function(e,t,n){e.exports=n.p+"static/media/plateau.a40c655a.svg"},62:function(e,t,n){e.exports=n.p+"static/media/robot.1ba7faeb.svg"},65:function(e,t,n){e.exports=n(173)},70:function(e,t,n){}},[[65,1,2]]]);
//# sourceMappingURL=main.36948925.chunk.js.map